<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Stopwatch + Timer + Counter + Clock</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  font-family: Arial, sans-serif;
  background: #f5f5f5;
  color: #222;
  margin: 0;
  padding: 20px;
  transition: 0.3s;
}

.dark {
  background: #121212;
  color: #eee;
}

.container {
  max-width: 450px;
  margin: auto;
  padding: 20px;
  border-radius: 14px;
  background: #fff;
  box-shadow: 0 5px 20px rgba(0,0,0,0.18);
  transition: 0.3s;
}

.dark .container {
  background: #5e5e5e;
}

h2 {
  text-align: center;
  margin-bottom: 15px;
}

/* Button style */
button {
  padding: 12px;
  font-size: 1.1rem;
  border-radius: 8px;
  border: 2px solid #1976d2;
  cursor: pointer;
  background: #2196f3;
  color: #fff;
  transition: 0.25s;
  width: 100%;
}
button:hover { background: #1e88e5; border-color:#42a5f5; }
button:active { background:#1565c0; }

.stop-btn { background:#e53935 !important; border-color:#ff5252 !important; }
.stop-btn:hover { background:#d32f2f !important; }

.export-btn { background:#6a1b9a !important; border-color:#9c27b0 !important; }
.export-btn:hover { background:#8e24aa !important; }

.utility-btn { background:#455a64 !important; border-color:#78909c !important; }
.utility-btn:hover { background:#37474f !important; }

/* Dark mode */
.dark button { background:#263238; border:2px solid #90caf9; color:#fff; }
.dark button:hover { background:#37474f; }

.dark .stop-btn { background:#b71c1c !important; border-color:#ef5350 !important; }
.dark .export-btn { background:#4a148c !important; border-color:#ba68c8 !important; }
.dark .utility-btn { background:#102027 !important; border-color:#4f5b62 !important; }

.row {
  display: flex;
  gap: 10px;
  margin-bottom: 10px;
}
.row button { flex:1; }

input {
  width: 100%;
  padding: 12px;
  border-radius: 8px;
  border: 2px solid #1976d2;
  font-size: 1.2rem;
  background: #fff;
}
.dark input { background:#263238; color:#fff; border-color:#90caf9; }

.laps-box {
  max-height: 140px;
  overflow-y: auto;
  margin-top: 10px;
  padding: 10px;
  border-radius: 8px;
  border: 1px solid #bbb;
  background: #fafafa;
}
.dark .laps-box { background:#1c1c1c; border-color:#555; }

.clock {
  font-size: 1.8rem;
  text-align: center;
  margin-bottom: 20px;
  font-weight: bold;
}
.timer-input {
  width: 100%;
  max-width: 350px;
  display: block;         /* required for margin auto */
  margin: 0 auto;         /* centers horizontally */
  text-align: center;     /* optional: centers the text inside */
}

</style>
</head>
<body>

<div class="container">

  <!-- CLOCK -->
  <div class="clock" id="liveClock">--:--:--</div>

  <button id="toggleTheme" class="utility-btn" style="margin-bottom:20px;">
    Toggle Dark / Light Mode
  </button>

  <!-- STOPWATCH -->
  <h2>⏱ Stopwatch</h2>
  <div id="swDisplay" style="font-size:2rem;text-align:center;margin-bottom:12px;">00:00:00.000</div>

  <div class="row">
    <button id="swStart">Start</button>
    <button id="swStop" class="stop-btn">Stop</button>
  </div>

  <div class="row">
    <button id="swLap" class="utility-btn">Lap</button>
    <button id="swReset" class="utility-btn">Reset</button>
  </div>

  <button id="swExport" class="export-btn" style="margin-bottom:15px;">Export Laps</button>

  <div class="laps-box" id="lapsBox"></div>


  <!-- COUNT-UP TIMER (NEW) -->
  <h2>⏳ Timer Counter (Count-Up)</h2>

  <div id="cuDisplay" style="font-size:2rem;text-align:center;margin:12px 0;">00:00</div>

  <div class="row">
    <button id="cuStart">Start</button>
    <button id="cuStop" class="stop-btn">Stop</button>
  </div>

  <button id="cuReset" class="utility-btn" style="margin-bottom:20px;">Reset</button>


  <!-- COUNTDOWN TIMER -->
  <h2>⏳ Countdown Timer</h2>

  <input id="timerInput" class="timer-input" placeholder="Enter seconds (example: 60)"/>

  <div id="timerDisplay" style="font-size:2rem;text-align:center;margin:12px 0;">00:00</div>

  <div class="row">
    <button id="tmStart">Start</button>
    <button id="tmStop" class="stop-btn">Stop</button>
  </div>
<div align=center><a href="https://zodiaclab.github.io/microapps/" style="color:var(--accent1);text-decoration:none">← Back / Home</a></div>

</div>


<!-- ALARM SOUND -->
<audio id="alarmSound">
  <source src="https://actions.google.com/sounds/v1/alarms/alarm_clock.ogg" type="audio/ogg">
</audio>

<script>
/* CLOCK */
function updateClock() {
  document.getElementById("liveClock").textContent =
    new Date().toLocaleTimeString();
}
setInterval(updateClock, 1000); updateClock();

/* THEME */
document.getElementById("toggleTheme").onclick = () =>
  document.body.classList.toggle("dark");


/* -------------------------
   STOPWATCH
--------------------------*/
let swRunning = false;
let swElapsed = 0;
let swStartTime = 0;
let swInterval;
const swDisplay = document.getElementById("swDisplay");

function fmtMS(ms) {
  let h = Math.floor(ms / 3600000);
  let m = Math.floor((ms % 3600000) / 60000);
  let s = Math.floor((ms % 60000) / 1000);
  let msPart = ms % 1000;
  return (
    String(h).padStart(2,"0") + ":" +
    String(m).padStart(2,"0") + ":" +
    String(s).padStart(2,"0") + "." +
    String(msPart).padStart(3,"0")
  );
}

document.getElementById("swStart").onclick = () => {
  if (!swRunning) {
    swRunning = true;
    swStartTime = Date.now() - swElapsed;
    swInterval = setInterval(() => {
      swElapsed = Date.now() - swStartTime;
      swDisplay.textContent = fmtMS(swElapsed);
    }, 10);
  }
};

document.getElementById("swStop").onclick = () => {
  swRunning = false;
  clearInterval(swInterval);
};

document.getElementById("swReset").onclick = () => {
  swRunning = false;
  clearInterval(swInterval);
  swElapsed = 0;
  swDisplay.textContent = "00:00:00.000";
  document.getElementById("lapsBox").innerHTML = "";
};

document.getElementById("swLap").onclick = () => {
  if (!swRunning) return;
  let lap = document.createElement("div");
  lap.textContent = fmtMS(swElapsed);
  lapsBox.appendChild(lap);
};

document.getElementById("swExport").onclick = () => {
  let lines = [];
  document.querySelectorAll("#lapsBox div").forEach(div => lines.push(div.textContent));
  if (!lines.length) return;
  const blob = new Blob([lines.join("\n")], { type:"text/csv" });
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "laps.csv";
  a.click();
};


/* -------------------------
   COUNT-UP TIMER  (NEW)
--------------------------*/
let cuInterval;
let cuSeconds = 0;
const cuDisplay = document.getElementById("cuDisplay");

function fmtMMSS(sec) {
  let m = Math.floor(sec / 60);
  let s = sec % 60;
  return String(m).padStart(2,"0") + ":" + String(s).padStart(2,"0");
}

document.getElementById("cuStart").onclick = () => {
  clearInterval(cuInterval);
  cuInterval = setInterval(() => {
    cuSeconds++;
    cuDisplay.textContent = fmtMMSS(cuSeconds);
  }, 1000);
};

document.getElementById("cuStop").onclick = () => {
  clearInterval(cuInterval);
};

document.getElementById("cuReset").onclick = () => {
  clearInterval(cuInterval);
  cuSeconds = 0;
  cuDisplay.textContent = "00:00";
};


/* -------------------------
   COUNTDOWN TIMER (FIXED)
--------------------------*/
let tmInterval;
let tmRemaining = 0;
const alarm = document.getElementById("alarmSound");

document.getElementById("tmStart").onclick = () => {
  let val = parseInt(document.getElementById("timerInput").value);

  if (!tmRemaining) {
    if (isNaN(val) || val <= 0) return;
    tmRemaining = val;
  }

  clearInterval(tmInterval);
  tmInterval = setInterval(() => {
    tmRemaining--;
    document.getElementById("timerDisplay").textContent = fmtMMSS(tmRemaining);

    if (tmRemaining <= 0) {
      clearInterval(tmInterval);
      tmRemaining = 0;
      document.getElementById("timerDisplay").textContent = "00:00";
      alarm.play();
    }
  }, 1000);
};

document.getElementById("tmStop").onclick = () => {
  clearInterval(tmInterval);
};
</script>

</body>
</html>

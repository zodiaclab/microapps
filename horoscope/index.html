<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vedic Moon Sign Calculator</title>
<style>
body {
  font-family: Poppins, sans-serif;
  background: linear-gradient(135deg, #f4f4f9, #e8f5e9);
  color: #222;
  text-align: center;
  padding: 40px;
}
.container {
  background: #fff;
  border-radius: 12px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
  max-width: 480px;
  margin: auto;
  padding: 30px;
}
input, button {
  padding: 10px;
  border-radius: 6px;
  border: 1px solid #ccc;
  width: 100%;
  margin-top: 8px;
}
button {
  background: #4caf50;
  color: white;
  cursor: pointer;
  transition: 0.3s;
}
button:hover {
  background: #45a049;
}
.result {
  margin-top: 20px;
  font-size: 1.1em;
}
</style>
</head>
<body>
  <div class="container">
    <h2>ðŸŒ• Vedic Moon Sign Calculator</h2>
    <p>Enter your birth details below</p>

    <input type="date" id="dob">
    <input type="time" id="tob">
    <input type="number" id="lat" placeholder="Latitude (e.g. 13.08)">
    <input type="number" id="lon" placeholder="Longitude (e.g. 80.27)">
    <button id="calcBtn">Calculate Moon Sign</button>

    <div class="result" id="output"></div>
  </div>

  <script type="module">
  import init, { swe_calc_ut, swe_julday, SE$MOON, SEFLG_SWIEPH } from "https://cdn.jsdelivr.net/npm/swisseph-wasm@latest/dist/swisseph-wasm.min.js";

  const signs = [
    "Aries (Mesha)", "Taurus (Rishabha)", "Gemini (Mithuna)", "Cancer (Karka)",
    "Leo (Simha)", "Virgo (Kanya)", "Libra (Tula)", "Scorpio (Vrischika)",
    "Sagittarius (Dhanu)", "Capricorn (Makara)", "Aquarius (Kumbha)", "Pisces (Meena)"
  ];

  document.getElementById('calcBtn').addEventListener('click', async () => {
    const dob = document.getElementById('dob').value;
    const tob = document.getElementById('tob').value || "12:00";
    const lat = parseFloat(document.getElementById('lat').value) || 13.08;
    const lon = parseFloat(document.getElementById('lon').value) || 80.27;

    if (!dob) {
      alert("Please enter date of birth");
      return;
    }

    document.getElementById('output').textContent = "Calculating...";

    await init(); // Initialize Swiss Ephemeris WASM

    const [year, month, day] = dob.split('-').map(Number);
    const [hour, minute] = tob.split(':').map(Number);
    const ut = hour + minute / 60;

    // Convert to Julian day
    const jd = swe_julday(year, month, day, ut);

    // Get Moon position
    const result = swe_calc_ut(jd, SE$MOON, SEFLG_SWIEPH);
    const lonMoon = result[0]; // longitude in degrees

    // Determine Rasi (Moon sign)
    const signIndex = Math.floor(lonMoon / 30);
    const moonSign = signs[signIndex];

    document.getElementById('output').innerHTML = `
      <strong>Moon Longitude:</strong> ${lonMoon.toFixed(2)}Â°<br>
      <strong>Vedic Moon Sign (Rasi):</strong> ${moonSign}
    `;
  });
  </script>
</body>
</html>

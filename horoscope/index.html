<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Astrology Micro App</title>
<style>
body { font-family: Arial, sans-serif; background:#f4f4f9; color:#222; text-align:center; padding:30px; }
.container { max-width:500px; margin:auto; background:#fff; padding:30px; border-radius:12px; box-shadow:0 4px 10px rgba(0,0,0,0.1); }
input, button { width:100%; padding:10px; margin:6px 0; border-radius:6px; border:1px solid #ccc; }
button { background:#4caf50; color:#fff; cursor:pointer; transition:0.3s; }
button:hover { background:#45a049; }
.result { margin-top:20px; font-size:1.1em; }
</style>
</head>
<body>
<div class="container">
  <h2>ðŸŒ• Astrology Micro App</h2>
  <p>Enter your birth details</p>

  <input type="date" id="dob">
  <input type="time" id="tob" value="12:00">
  <input type="number" id="lat" placeholder="Latitude (e.g. 13.08)">
  <input type="number" id="lon" placeholder="Longitude (e.g. 80.27)">
  <button id="calcBtn">Calculate Charts</button>

  <div class="result" id="output"></div>
</div>

<script type="module">
// Load the required astronomy library from CDN
import { julian, moonposition } from "https://cdn.jsdelivr.net/npm/astronomia@1.12.0/dist/astronomia.esm.js";

// Zodiac tables
const vedicRasis = ["Aries", "Taurus", "Gemini", "Cancer", "Leo", "Virgo", "Libra", "Scorpio", "Sagittarius", "Capricorn", "Aquarius", "Pisces"];
const westernZodiacs = [
  { sign:"Aries", start:"03-21", end:"04-19" },
  { sign:"Taurus", start:"04-20", end:"05-20" },
  { sign:"Gemini", start:"05-21", end:"06-20" },
  { sign:"Cancer", start:"06-21", end:"07-22" },
  { sign:"Leo", start:"07-23", end:"08-22" },
  { sign:"Virgo", start:"08-23", end:"09-22" },
  { sign:"Libra", start:"09-23", end:"10-22" },
  { sign:"Scorpio", start:"10-23", end:"11-21" },
  { sign:"Sagittarius", start:"11-22", end:"12-21" },
  { sign:"Capricorn", start:"12-22", end:"01-19" },
  { sign:"Aquarius", start:"01-20", end:"02-18" },
  { sign:"Pisces", start:"02-19", end:"03-20" }
];
const chineseZodiacs = ["Rat","Ox","Tiger","Rabbit","Dragon","Snake","Horse","Goat","Monkey","Rooster","Dog","Pig"];

const simplePredictions = {
  Vedic:"A period of personal growth and opportunity awaits you. Be careful with finances.",
  Western:"Your energy and enthusiasm will attract good things. Stay focused on goals.",
  Chinese:"Luck and prosperity are coming. Pay attention to relationships."
};

function getVedicRasi(lon){
  const idx = Math.floor(lon/30);
  return vedicRasis[idx];
}

function getWesternSign(month, day){
  let sign = "Unknown";
  westernZodiacs.forEach(z=>{
    let [startM,startD]=z.start.split("-").map(Number);
    let [endM,endD]=z.end.split("-").map(Number);
    if((month===startM && day>=startD) || (month===endM && day<=endD) ||
       (startM>endM && ((month===startM && day>=startD)||(month===endM && day<=endD)))){
      sign=z.sign;
    }
  });
  return sign;
}

document.getElementById('calcBtn').addEventListener('click', ()=>{
  const dob=document.getElementById('dob').value;
  const tob=document.getElementById('tob').value || "12:00";
  const lat=parseFloat(document.getElementById('lat').value)||13.08;
  const lon=parseFloat(document.getElementById('lon').value)||80.27;

  if(!dob){ alert("Please enter date of birth"); return; }

  const [y,m,d]=dob.split("-").map(Number);
  const [hh,mm]=tob.split(":").map(Number);
  const jd = julian.CalendarGregorianToJD(y, m, d) + (hh + mm/60)/24;

  // Moon position using astronomy library
  const moonLon = moonposition.position(jd).lon * (180/Math.PI); // radians â†’ degrees
  const vedicSign = getVedicRasi(moonLon);
  const westernSign = getWesternSign(m, d);
  const chineseSign = chineseZodiacs[(y-1900)%12];

  document.getElementById('output').innerHTML=`
    <strong>Vedic Moon Sign:</strong> ${vedicSign} (${moonLon.toFixed(2)}Â°)<br>
    <strong>Western Zodiac:</strong> ${westernSign}<br>
    <strong>Chinese Zodiac:</strong> ${chineseSign}<br><br>
    <strong>Predictions:</strong><br>
    Vedic: ${simplePredictions.Vedic}<br>
    Western: ${simplePredictions.Western}<br>
    Chinese: ${simplePredictions.Chinese}
  `;
});
</script>
</body>
</html>
